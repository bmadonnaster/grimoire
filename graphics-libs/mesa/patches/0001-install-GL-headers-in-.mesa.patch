From 2dad413e70bb47131da58043537aaf669b0c6f5f Mon Sep 17 00:00:00 2001
From: Treeve Jelbert <treeve@sourcemage.org>
Date: Wed, 18 Oct 2017 20:30:00 +0200
Subject: [PATCH 1/2] install GL headers in .mesa install libGL to lib/.mesa
 install libEGL.so* into lib/.mesa

---
 include/meson.build         | 6 +++---
 src/egl/meson.build         | 1 +
 src/glx/meson.build         | 1 +
 src/mapi/es2api/meson.build | 1 +
 4 files changed, 6 insertions(+), 3 deletions(-)

diff --git a/include/meson.build b/include/meson.build
index 081c1bc0008..93e884ec525 100644
--- a/include/meson.build
+++ b/include/meson.build
@@ -50,16 +50,16 @@ endif
 if with_opengl
   install_headers(
     'GL/gl.h', 'GL/glext.h', 'GL/glcorearb.h', 'GL/gl_mangle.h',
-    subdir : 'GL',
+    subdir : 'GL/.mesa',
   )
 endif
 
 if with_glx != 'disabled'
-  install_headers('GL/glx.h', 'GL/glxext.h', 'GL/glx_mangle.h', subdir : 'GL')
+  install_headers('GL/glx.h', 'GL/glxext.h', 'GL/glx_mangle.h', subdir : 'GL/.mesa')
 endif
 
 if with_osmesa != 'none'
-  install_headers('GL/osmesa.h', subdir : 'GL')
+  install_headers('GL/osmesa.h', subdir : 'GL/.mesa')
 endif
 
 if with_egl
diff --git a/src/egl/meson.build b/src/egl/meson.build
index b7ff09e9fed..bea2f7ffe30 100644
--- a/src/egl/meson.build
+++ b/src/egl/meson.build
@@ -170,6 +170,7 @@ libegl = shared_library(
   dependencies : [deps_for_egl, dep_dl, dep_libdrm, dep_clock, dep_thread],
   install : true,
   version : egl_lib_version,
+  install_dir : 'lib/.mesa',
 )
 
 # If using glvnd the pkg-config header should not point to EGL_mesa, it should
diff --git a/src/glx/meson.build b/src/glx/meson.build
index 061e026e53f..e236a2b5db1 100644
--- a/src/glx/meson.build
+++ b/src/glx/meson.build
@@ -164,6 +164,7 @@ libgl = shared_library(
   ],
   version : gl_lib_version,
   install : true,
+  install_dir : 'lib/.mesa'
 )
 
 if with_tests
diff --git a/src/mapi/es2api/meson.build b/src/mapi/es2api/meson.build
index a7f0904b699..9935df71f90 100644
--- a/src/mapi/es2api/meson.build
+++ b/src/mapi/es2api/meson.build
@@ -40,6 +40,7 @@ libgles2 = shared_library(
   dependencies : [dep_thread, dep_libdrm, dep_m, dep_dl],
   version : '2.0.0',
   install : true,
+  install_dir : 'lib/.mesa'
 )
 
 pkg.generate(
-- 
2.21.0

