# special functions for projects shich use meson build system
PREFIX=${PREFIX:-/usr}
meson_build () {
  MESON_BUILD_TYPE="${MESON_BUILD_TYPE:-release}"
#  export LANG=$LC_ALL
  cd $SOURCE_DIRECTORY
# do not put / before PREFIX
  SCRIPT="meson --prefix ${INSTALL_ROOT}$PREFIX --buildtype ${MESON_BUILD_TYPE} \
 --default-library shared --libdir lib"
  for LL in $OPTS; do
    SCRIPT+=" -D$LL"
  done
  SCRIPT+=" .  builddir/"
  $SCRIPT &&

  if type ninja >/dev/null 2>&1; then
    NINJA="ninja"
  else
    NINJA="samu"
  fi &&
  export NINJA &&

  ${NINJA} -j "$MAKE_NJOBS" -C builddir/
}

meson_install () {
  cd $SOURCE_DIRECTORY
  ${NINJA} -C builddir/ install
}

default_build() {
 meson_build
}

default_install() {
  meson_install
}
