. "$GRIMOIRE/FUNCTIONS" &&

depends ninja-build-system &&
depends meson &&
depends pkgconfig &&
depends libffi  &&
depends gettext &&
depends xz-utils &&

optional_depends elfutils '' '' 'manipulate ELF files' &&

if  !  spell_installed  pkgconfig;  then
  force_depends  pkgconfig
fi  &&

depends perl      &&
# It used to be optional, but cannot be until we figure out what to do
# about gdbus-codegen. INSTALL fails without python and leaves us
# without glib2, which can break other serious stuff.
#optional_depends PYTHON                       \
#                 "--enable-modular-tests"     \
#                 "--disable-modular-tests"    \
#                 "Perform post-build testing" &&
depends PYTHON    &&

optional_depends -sub UTFPROP pcre                  \
                 ""              \
                 "internal_pcre=true"               \
                 "Use system supplied PCRE. Otherwise, the internal PCRE library will be used" &&

if is_depends_enabled $SPELL pcre; then
  if spell_ok pcre && is_version_less $(installed_version pcre) 8.11; then
    force_depends pcre
  fi
fi &&

optional_depends attr                       \
                 "xattr=true"               \
                 "xattr=false"              \
                 "Build with xattr support" &&

# Merge on next stable release
if [[ "${GLIB_VER}" == "devel" ]];then
  optional_depends libselinux                   \
                   "selinux=enabled"            \
                   "selinux=disabled"           \
                   "Build with selinux support"
else
  optional_depends libselinux                   \
                   "selinux=true"               \
                   "selinux=false"              \
                   "Build with selinux support"
fi &&

optional_depends gtk-doc                            \
                 "gtk_doc=true"                     \
                 "gtk_doc=false"                    \
                 "Build documentation with gtk-doc" &&

optional_depends libxslt           \
                 "man=true"        \
                 "man=false"       \
                 "Generate man pages" &&

optional_depends systemtap                               \
                 "systemtap=true"                        \
                 "systemtap=false"                       \
                 "Include tracing support for systemtap" &&

optional_depends util-linux                    \
                 "libmount=true"               \
                 "libmount=false"              \
                 "Build with libmount support" &&

depends zlib
