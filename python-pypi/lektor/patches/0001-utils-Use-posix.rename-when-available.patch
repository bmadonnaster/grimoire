From e4301e9b78000d622731c79afcb01d436a79c3c2 Mon Sep 17 00:00:00 2001
From: Ismael Luceno <ismael@iodev.co.uk>
Date: Tue, 25 May 2021 20:19:25 +0200
Subject: [PATCH] utils: Use posix.rename when available

Upstream-Status: Pending
Signed-off-by: Ismael Luceno <ismael@iodev.co.uk>
---
 lektor/builder.py | 5 ++++-
 lektor/utils.py   | 5 ++++-
 2 files changed, 8 insertions(+), 2 deletions(-)

diff --git a/lektor/builder.py b/lektor/builder.py
index 93572fd8f0dc..9004a9a02570 100644
--- a/lektor/builder.py
+++ b/lektor/builder.py
@@ -11,7 +11,10 @@ from contextlib import contextmanager
 from itertools import chain
 
 import click
-from werkzeug.posixemulation import rename
+try:
+    from posix import rename
+except ImportError:
+    from werkzeug.posixemulation import rename
 
 from lektor.build_programs import builtin_build_programs
 from lektor.buildfailures import FailureController
diff --git a/lektor/utils.py b/lektor/utils.py
index 2402a0aded72..c03c06eb4000 100644
--- a/lektor/utils.py
+++ b/lektor/utils.py
@@ -25,8 +25,11 @@ from markupsafe import Markup
 from slugify import slugify as _slugify
 from werkzeug import urls
 from werkzeug.http import http_date
-from werkzeug.posixemulation import rename
 from werkzeug.urls import url_parse
+try:
+    from posix import rename
+except ImportError:
+    from werkzeug.posixemulation import rename
 
 
 is_windows = os.name == "nt"
-- 
2.31.1

